var MMCQ,PriorityQueue;PriorityQueue=function(){function t(t){this.comparator=t,this.contents=[],this.sorted=!1}return t.prototype.sort=function(){return this.contents.sort(this.comparator),this.sotred=!0},t.prototype.push=function(t){return this.contents.push(t),this.sorted=!1},t.prototype.peek=function(t){return null==t&&(t=this.contents.length-1),this.sorted||this.sort(),this.contents[t]},t.prototype.pop=function(){return this.sorted||this.sort(),this.contents.pop()},t.prototype.size=function(){return this.contents.length},t.prototype.map=function(t){return this.contents.map(t)},t}(),MMCQ=function(){function t(){this.maxIterations=1e3,this.fractByPopulations=.75}var o,r,e,n,s,i;return t.sigbits=5,t.rshift=8-t.sigbits,n=function(o,r,e){return(o<<2*t.sigbits)+(r<<t.sigbits)+e},o=function(){function o(t,o,r,e,n,s,i){this.r1=t,this.r2=o,this.g1=r,this.g2=e,this.b1=n,this.b2=s,this.histo=i}return o.prototype.volume=function(t){return this._volume&&!t||(this._volume=(this.r2-this.r1+1)*(this.g2-this.g1+1)*(this.b2-this.b1+1)),this._volume},o.prototype.count=function(t){var o,r,e,s,i,c,h,u,a,f,p;if(!this._count_set||t){for(s=0,i=c=this.r1,a=this.r2;c<=a;i=c+=1)for(r=h=this.g1,f=this.g2;h<=f;r=h+=1)for(o=u=this.b1,p=this.b2;u<=p;o=u+=1)e=n(i,r,o),s+=this.histo[e]||0;this._count_set=!0,this._count=s}return this._count},o.prototype.copy=function(){return new o(this.r1,this.r2,this.g1,this.g2,this.b1,this.b2,this.histo)},o.prototype.average=function(o){var r,e,s,i,c,h,u,a,f,p,l,g,m,b,d,v;if(!this._average||o){for(u=1<<8-t.sigbits,p=0,f=0,i=0,e=0,a=l=this.r1,b=this.r2;l<=b;a=l+=1)for(s=g=this.g1,d=this.g2;g<=d;s=g+=1)for(r=m=this.b1,v=this.b2;m<=v;r=m+=1)h=n(a,s,r),p+=c=this.histo[h]||0,f+=c*(a+.5)*u,i+=c*(s+.5)*u,e+=c*(r+.5)*u;this._average=p?[~~(f/p),~~(i/p),~~(e/p)]:[~~(u*(this.r1+this.r2+1)/2),~~(u*(this.g1+this.g2+1)/2),~~(u*(this.b1+this.b2+1)/2)]}return this._average},o.prototype.contains=function(o){var r,e,n;return n=o[0]>>t.rshift,e=o[1]>>t.rshift,r=o[2]>>t.rshift,this.r1<=n&&n<=this.r2&&this.g1<=e&&e<=this.g2&&this.b1<=r&&r<=this.b2},o}(),r=function(){function t(){this.cboxes=new PriorityQueue(function(t,o){var r,e;return r=t.count()*t.volume(),e=o.count()*o.volume(),r>e?1:r<e?-1:0})}return t.prototype.push=function(t){return this.cboxes.push({cbox:t,color:t.average()})},t.prototype.palette=function(){return this.cboxes.map(function(t){return t.color})},t.prototype.size=function(){return this.cboxes.size()},t.prototype.map=function(t){var o,r,e;for(o=r=0,e=this.cboxes.size();r<e;o=r+=1)return this.cboxes.peek(o).cbox.contains(t)?this.cboxes.peek(o).color:this.nearest(t)},t.prototype.cboxes=function(){return this.cboxes},t.prototype.nearest=function(t){var o,r,e,n,s,i,c;for(s=function(t){return t*t},e=1e9,r=i=0,c=this.cboxes.size();i<c;r=i+=1)(o=Math.sqrt(s(t[0]-this.cboxes.peek(r).color[0])+s(t[1]-this.cboxes.peek(r).color[1])+s(t[2]-this.cboxes.peek(r).color[2])))<e&&(e=o,n=this.cboxes.peek(r).color);return n},t}(),s=function(o){var r,e,s,i,c,h,u,a,f;for(i=1<<3*t.sigbits,s=new Array(i),a=0,f=o.length;a<f;a++)u=(h=o[a])[0]>>t.rshift,e=h[1]>>t.rshift,r=h[2]>>t.rshift,s[c=n(u,e,r)]=(s[c]||0)+1;return s},e=function(r,e){var n,s,i,c,h,u,a,f,p,l,g,m;for(l=1e6,p=0,u=1e6,h=0,i=1e6,s=0,g=0,m=r.length;g<m;g++)f=(a=r[g])[0]>>t.rshift,c=a[1]>>t.rshift,n=a[2]>>t.rshift,f<l?l=f:f>p&&(p=f),c<u?u=c:c>h&&(h=c),n<i?i=n:n>s&&(s=n);return new o(l,p,u,h,i,s,e)},i=function(t,o){var r,e,s,i,c,h,u,a,f,p,l,g,m,b,d,v,x,y,C,j,w,_,k,M,P,z,Q,I,F,D;if(o.count()){if(1===o.count())return[o.copy()];if(p=o.r2-o.r1+1,c=o.g2-o.g1+1,e=o.b2-o.b1+1,u=Math.max(p,c,e),g=0,a=[],h=[],u===p)for(f=m=o.r1,_=o.r2;m<=_;f=m+=1){for(l=0,i=b=o.g1,Q=o.g2;b<=Q;i=b+=1)for(r=d=o.b1,I=o.b2;d<=I;r=d+=1)l+=t[n(f,i,r)]||0;g+=l,a[f]=g}else if(u===c)for(i=v=o.g1,F=o.g2;v<=F;i=v+=1){for(l=0,f=x=o.r1,D=o.r2;x<=D;f=x+=1)for(r=y=o.b1,k=o.b2;y<=k;r=y+=1)l+=t[n(f,i,r)]||0;g+=l,a[i]=g}else for(r=C=o.b1,M=o.b2;C<=M;r=C+=1){for(l=0,f=j=o.r1,P=o.r2;j<=P;f=j+=1)for(i=w=o.g1,z=o.g2;w<=z;i=w+=1)l+=t[n(f,i,r)]||0;g+=l,a[r]=g}return a.forEach(function(t,o){return h[o]=g-t}),s=function(t){var r,e,n,s,i,c,u,f,p,l,m;for(c=t+"2",u=l=o[i=t+"1"],m=o[c];l<=m;u=l+=1)if(a[u]>g/2){for(r=o.copy(),e=o.copy(),s=(f=u-o[i])<=(p=o[c]-u)?Math.min(o[c]-1,~~(u+p/2)):Math.max(o[i],~~(u-1-f/2));!a[s];)s++;for(n=h[s];!n&&a[s-1];)n=h[--s];return r[c]=s,e[i]=r[c]+1,[r,e]}},u===p?s("r"):u===c?s("g"):u===e?s("b"):void 0}},t.prototype.quantize=function(t,o){var n,c,h,u,a,f,p=this;if(!t.length||o<2||o>256)return console.log("invalid arguments"),!1;for(h=s(t),n=e(t,h),(a=new PriorityQueue(function(t,o){var r,e;return r=t.count(),e=o.count(),r>e?1:r<e?-1:0})).push(n),(u=function(t,o){var r,e,s,c,u;for(c=1,u=0;u<p.maxIterations;)if((n=t.pop()).count()){if(s=i(h,n),r=s[0],e=s[1],!r)return void console.log("cbox1 not defined; shouldn't happen");if(t.push(r),e&&(t.push(e),c++),c>=o)return;if(u++>p.maxIterations)return void console.log("infinite loop; perhaps too few pixels")}else t.push(n),u++})(a,this.fractByPopulations*o),f=new PriorityQueue(function(t,o){var r,e;return r=t.count()*t.volume(),e=o.count()*o.volume(),r>e?1:r<e?-1:0});a.size();)f.push(a.pop());for(u(f,o-f.size()),c=new r;f.size();)c.push(f.pop());return c},t}.call(this),function(){window.ColorExtract=function(){function t(){}return t.getColorMap=function(t,o,r,e,n,s){var i,c,h,u,a,f,p,l,g,m;for(null==s&&(s=8),h=t.getContext("2d").getImageData(o,r,e,n).data,u=[],f=p=r,g=r+n;p<g;f=p+=1)for(c=f*e*4,a=l=o,m=o+e;l<m;a=l+=1)i=c+4*a,u.push([h[i],h[i+1],h[i+2]]);return(new MMCQ).quantize(u,s)},t.colorDist=function(t,o){var r;return(r=function(t){return t*t})(t[0]-o[0])+r(t[1]-o[1])+r(t[2]-o[2])},t.extract=function(o,r,e){var n,s,i,c,h,u,a,f,p,l,g,m,b;for(r.width=25,r.height=25,r.getContext("2d").drawImage(o,0,0,r.width,r.height),(s=t.getColorMap(r,0,0,r.width,r.height,4).cboxes.map(function(t){return{count:t.cbox.count(),rgb:t.color}})).sort(function(t,o){return o.count-t.count}),n=s[0].rgb,(a=t.getColorMap(r,0,0,o.width,o.height,10).cboxes.map(function(t){return{count:t.cbox.count(),rgb:t.color}})).sort(function(t,o){return o.count-t.count}),f=0,l=0,m=a.length;l<m;l++)i=a[l],(c=t.colorDist(n,i.rgb))>f&&(f=c,h=i.rgb);for(f=0,g=0,b=a.length;g<b;g++)i=a[g],(c=t.colorDist(n,i.rgb))>f&&i.rgb!==h&&(f=c,u=i.rgb);return p=function(t){return"rgb("+t[0]+", "+t[1]+", "+t[2]+")"},e({bgColor:p(n),fgColor:p(h),fgColor2:p(u)})},t}()}.call(this),function(t){var o=function(){return t("html").hasClass("editmode")};window.site=t.extend(window.site||{},{initBlogPage:function(){},initArticlePage:function(){},initCommonPage:function(){handleFormFieldClick()},bindSiteSearch:function(o,r,e){o&&new VoogSearch(o,{per_page:10,lang:r,resultsContainer:t(".js-voog-search-modal-inner").get(0),sideclick:!0,mobileModeWidth:480,updateOnKeypress:!0,noResults:e})}}),t(".content").on("mousedown",function(o){t(o.target).closest(".js-prevent-sideclick").length||t(".js-popover").removeClass("expanded")}),t(".js-menu-btn").click(function(o){o.stopPropagation(),t(this).toggleClass("open"),t(".js-menu-main").toggleClass("expanded"),t(".js-search-close-btn").hasClass("open")&&t(".js-search-close-btn").trigger("click")}),t(".js-menu-lang-btn").click(function(o){o.stopPropagation(),t(".js-menu-lang-popover").toggleClass("expanded")}),t(".js-search-open-btn").click(function(o){o.stopPropagation(),t(".js-menu-main").hasClass("expanded")&&(t(".js-menu-main").removeClass("expanded"),t(".js-menu-btn").removeClass("open")),t(this).addClass("open"),t("body").addClass("search-open"),t(".js-search-close-btn").addClass("open"),t(".js-search").addClass("active"),t(".js-search-inner").css({"margin-top":"-25px"}),t(".js-search-input").val("").focus()}),t(".js-search-close-btn").click(function(o){t(this).removeClass("open"),t("body").removeClass("search-open"),t(".js-search-open-btn").removeClass("open"),t(".js-search").removeClass("active")}),t(".js-search").click(function(t){t.stopPropagation()}),t(document).ready(function(){t(".comment-form").hasClass("form_with_errors")?t("html, body").scrollTop(t(".comment-form").offset().top):t("form").find(".form_error, .form_notice").length>0&&t("html, body").scrollTop(t(".form_error, .form_notice").closest("form").offset().top)}),searchForm=t(".js-search-form"),t(".js-search-input").focus(function(){searchForm.addClass("active")}).blur(function(){searchForm.removeClass("active")}),t(".js-search-form").on("submit",function(){searchModalHeight=t(".js-voog-search-modal").height(),t(".js-modal").css({top:"40px"})}),!1===o&&t.each(t(".content-formatted"),function(){t(this).hasClass("js-custom-content-formatted")||t(this).find("table").wrap('<div class="table-container overthrow"></div>')}),!Modernizr.flexbox&&o&&function(){var o=t(".js-header").width(),r=t(".js-header-right"),e=r.width(),n=parseInt(r.css("margin-left"))+1;t(".js-header-left").css("min-width",o-e-n)}()}(jQuery);